<html>
<head>

</head>
<body style="padding: 0; margin: 0">


<canvas id="canvas" width="800" height="600" 
	style="
		width: 100%; height: 100%;
		grid-column: 1; grid-row: 1">
</canvas>

<span style="position: fixed; z-index: 100; left: 10px; top: 10px;">
	
</span>

<script src="./libs/gl-matrix.js"></script>

<script type="module" async>
	
	import {PotreeLoader} from "./src/octree/PotreeLoader.js";
	import {Geometry} from "./src/Geometry.js";
	import {Mesh} from "./src/scene/Mesh.js";
	import {Vector3} from "./src/math/Vector3.js";
	import {Lines} from "./src/scene/Lines.js";
	import {Potree} from "./src/Potree.js";

	let canvas = document.getElementById("canvas");
	new Potree().init(canvas).then((viewer) => {
		window.potree = viewer;
		
		let scene = viewer.scene;
		window.scene = scene;

		let box = Geometry.createBox();
		let node = new Mesh("box", box);
		scene.root.add(node);

		let node2 = new Mesh("box2", box);
		node2.position.set(1, 1, -0.3);
		node2.scale.set(0.5, 0.5, 0.5);
		scene.root.add(node2);

		viewer.controls.yaw = 0.4637935622452329;
		viewer.controls.pitch = -0.4136537176781808;
		viewer.controls.radius = 100;
		// viewer.controls.target.set(
		// 	0.2250017942518924, 
		// 	-0.3310930078099392, 
		// 	3.829165648605102
		// );

		viewer.controls.target.set(693983.231, 3915824.074, 53.839);

		// 693350.589, 3914914.483, 664.125
		// 693983.231, 3915824.074, 53.839



		//let url = "http://localhost:8080/nocommit/lion/metadata.json";
		let url = "http://localhost:8080/nocommit/morro/metadata.json";
		PotreeLoader.load(url).then( async (pointcloud) => {

			window.dbg = pointcloud;

			pointcloud.loader.loadHierarchy(pointcloud.root);
			pointcloud.loader.loadNode(pointcloud.root);

			scene.root.add(pointcloud);
		});

		viewer.addListener("update", (e) => {

			// viewer.renderer.drawBoundingBox({
			// 	position: new Vector3(1, 1, 1),
			// 	scale: new Vector3(1, 1, 1),
			// });

			// viewer.renderer.drawBoundingBox({
			// 	position: new Vector3(3, 1, 1),
			// 	scale: new Vector3(0.5, 0.5, 0.5),
			// });

		});

	});

	


</script>



</body>
</html>